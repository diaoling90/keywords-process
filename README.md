
# å…³é”®è¯ç®¡ç†å·¥å…·

ä¸€ä¸ªç”¨äºç®¡ç†å…³é”®è¯å¹¶ç”Ÿæˆ Google Trends é“¾æ¥çš„ Web åº”ç”¨ç¨‹åºã€‚

## åŠŸèƒ½ç‰¹ç‚¹

- **ä¸»å…³é”®è¯ç®¡ç†**: è¾“å…¥å’Œä¿å­˜ä¸»å…³é”®è¯åˆ° `defaultkw.json` æ–‡ä»¶ï¼Œæ”¯æŒå»é‡ä¿å­˜
- **æ—¶é—´è¿‡æ»¤**: æ ¹æ®ä½¿ç”¨æ—¶é—´è¿‡æ»¤æ•°æ®åº“ä¸­çš„å…³é”®è¯
- **å¡ç‰‡å±•ç¤º**: å°†æ•°æ®åº“å…³é”®è¯æŒ‰æ¯4ä¸ªä¸€ç»„å±•ç¤ºï¼Œæ¯ç»„åŠ ä¸Šä¸»å…³é”®è¯å½¢æˆ5ä¸ªè¯çš„å¡ç‰‡
- **Google Trends é›†æˆ**: ç‚¹å‡»å¡ç‰‡æŒ‰é’®è‡ªåŠ¨æ‰“å¼€ Google Trends é¡µé¢
- **ä½¿ç”¨æ—¶é—´è¿½è¸ª**: æ¯æ¬¡ä½¿ç”¨å…³é”®è¯æ—¶è‡ªåŠ¨æ›´æ–°æ•°æ®åº“ä¸­çš„ä½¿ç”¨æ—¶é—´
- **URL å…³é”®è¯å¤„ç†**: è‡ªåŠ¨å°† URL æ ¼å¼çš„å…³é”®è¯è½¬æ¢ä¸ºå¯è¯»çš„å…³é”®è¯
- **æ‰¹é‡å¯¼å…¥**: æ”¯æŒä»WPS/Excelæ–‡ä»¶æ‰¹é‡å¯¼å…¥å…³é”®è¯ï¼Œè‡ªåŠ¨å»é‡
- **å›¾å½¢åŒ–å¯¼å…¥å·¥å…·**: Python GUIå·¥å…·ï¼Œæ”¯æŒæ–‡ä»¶é¢„è§ˆã€è¿›åº¦æ˜¾ç¤ºã€æ•°æ®ç»Ÿè®¡
- **å¤šæ–‡ä»¶æ”¯æŒ**: å¯åŒæ—¶é€‰æ‹©å¤šä¸ªExcelæ–‡ä»¶è¿›è¡Œæ‰¹é‡å¤„ç†
- **æ™ºèƒ½åˆ—è¯†åˆ«**: è‡ªåŠ¨æŸ¥æ‰¾å…³é”®è¯åˆ—ï¼Œæ”¯æŒè‡ªå®šä¹‰åˆ—å
- **ç´§å‡‘å¸ƒå±€**: å“åº”å¼è®¾è®¡ï¼Œé€‚é…ä¸åŒå±å¹•å°ºå¯¸

## å®‰è£…æ­¥éª¤

### 1. åˆå§‹åŒ–é¡¹ç›®ï¼ˆå¯é€‰ï¼‰

å¦‚æœæ‚¨æƒ³ä½¿ç”¨Gitè¿›è¡Œç‰ˆæœ¬æ§åˆ¶ï¼š

```bash
# åˆå§‹åŒ–Gitä»“åº“
git init

# æ·»åŠ æ‰€æœ‰æ–‡ä»¶
git add .

# æäº¤åˆå§‹ç‰ˆæœ¬
git commit -m "åˆå§‹åŒ–å…³é”®è¯ç®¡ç†å·¥å…·é¡¹ç›®"
```

### 2. å®‰è£…Node.jsä¾èµ–

```bash
npm install
```

### 3. å®‰è£…Pythonä¾èµ–

```bash
pip install pandas pymongo openpyxl xlrd
```

### 4. ç¡®ä¿ MongoDB è¿è¡Œ

ç¡®ä¿æ‚¨çš„æœ¬åœ° MongoDB æœåŠ¡æ­£åœ¨è¿è¡Œï¼ˆé»˜è®¤ç«¯å£ 27017ï¼‰ã€‚

### 5. åˆå§‹åŒ–ç¤ºä¾‹æ•°æ®ï¼ˆå¯é€‰ï¼‰

```bash
npm run init-data
```

è¿™ä¼šåœ¨æ•°æ®åº“ä¸­æ·»åŠ ä¸€äº›ç¤ºä¾‹å…³é”®è¯ç”¨äºæµ‹è¯•ã€‚

### 6. å¯åŠ¨æœåŠ¡å™¨

```bash
npm start
```

æˆ–è€…ä½¿ç”¨å¼€å‘æ¨¡å¼ï¼ˆè‡ªåŠ¨é‡å¯ï¼‰ï¼š

```bash
npm run dev
```

### 7. è®¿é—®åº”ç”¨

åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ `http://localhost:3000`

## ä½¿ç”¨è¯´æ˜

### 1. ä¸»å…³é”®è¯æ“ä½œ
- é¡µé¢åŠ è½½æ—¶ä¼šè‡ªåŠ¨ä» `defaultkw.json` è¯»å–ç¬¬ä¸€ä¸ªå…³é”®è¯ä½œä¸ºé»˜è®¤å€¼
- åœ¨ä¸»å…³é”®è¯è¾“å…¥æ¡†ä¸­è¾“å…¥æ–°çš„å…³é”®è¯ï¼Œç‚¹å‡»"ä¿å­˜"æŒ‰é’®ä¿å­˜åˆ°æ–‡ä»¶
- ä¿å­˜çš„å…³é”®è¯ä¼šè‡ªåŠ¨å»é‡ï¼Œæ–°å…³é”®è¯ä¼šæ·»åŠ åˆ°åˆ—è¡¨å¼€å¤´

### 2. æ—¶é—´è¿‡æ»¤
- æ—¶é—´è¾“å…¥æ¡†é»˜è®¤æ˜¾ç¤ºå½“å‰æ—¶é—´
- ä¿®æ”¹æ—¶é—´åç‚¹å‡»"åˆ·æ–°"æŒ‰é’®ï¼Œåªæ˜¾ç¤ºä½¿ç”¨æ—¶é—´æ—©äºè®¾å®šæ—¶é—´çš„å…³é”®è¯
- è¿™æœ‰åŠ©äºæ‰¾åˆ°é•¿æ—¶é—´æœªä½¿ç”¨çš„å…³é”®è¯

### 3. å…³é”®è¯å¡ç‰‡
- æ¯ä¸ªå¡ç‰‡åŒ…å« 5 ä¸ªå…³é”®è¯ï¼š1 ä¸ªä¸»å…³é”®è¯ + 4 ä¸ªæ•°æ®åº“å…³é”®è¯
- ä¸»å…³é”®è¯ä»¥è“è‰²èƒŒæ™¯æ˜¾ç¤º
- ç‚¹å‡»"æŸ¥çœ‹ Google è¶‹åŠ¿"æŒ‰é’®ä¼šï¼š
  - æ›´æ–°æ•°æ®åº“ä¸­ç›¸å…³å…³é”®è¯çš„ä½¿ç”¨æ—¶é—´
  - æ‰“å¼€æ–°çª—å£æ˜¾ç¤º Google Trends é¡µé¢

### 4. æ‰¹é‡å¯¼å…¥Excelæ–‡ä»¶

#### æ–¹æ³•ä¸€ï¼šé€šè¿‡ç½‘é¡µæŒ‰é’®å¯åŠ¨

- åœ¨ä¸»é¡µé¢ç‚¹å‡»"å¯¼å…¥Excelæ–‡ä»¶"æŒ‰é’®
- ç³»ç»Ÿä¼šå°è¯•è‡ªåŠ¨å¯åŠ¨Pythonå¯¼å…¥å·¥å…·
- å¦‚æœè‡ªåŠ¨å¯åŠ¨å¤±è´¥ï¼Œä¼šæ˜¾ç¤ºæ‰‹åŠ¨å¯åŠ¨è¯´æ˜

#### æ–¹æ³•äºŒï¼šæ‰‹åŠ¨å¯åŠ¨Pythonå·¥å…·

**Windows ç”¨æˆ·ï¼š**
```bash
# æ–¹å¼1ï¼šä½¿ç”¨æ‰¹å¤„ç†è„šæœ¬ï¼ˆæ¨èï¼‰
start_import_tool.bat

# æ–¹å¼2ï¼šç›´æ¥è¿è¡ŒPythonè„šæœ¬
python import_keywords.py
```

**Linux/Mac ç”¨æˆ·ï¼š**
```bash
python import_keywords.py
```

åœ¨å¼¹å‡ºçš„å›¾å½¢ç•Œé¢ä¸­ï¼š
- é€‰æ‹©ä¸€ä¸ªæˆ–å¤šä¸ªWPS/Excelæ–‡ä»¶
- è®¾ç½®å…³é”®è¯åˆ—åï¼ˆé»˜è®¤ä¸º 'Keyword'ï¼‰
- é¢„è§ˆæ•°æ®ç¡®è®¤
- å¯¼å…¥åˆ°æ•°æ®åº“ï¼ˆè‡ªåŠ¨å»é‡ï¼‰

#### æ–¹æ³•ä¸‰ï¼šä½¿ç”¨ API æ¥å£

```bash
curl -X POST http://localhost:3000/api/keywords \
  -H "Content-Type: application/json" \
  -d '{"keyword": "ä½ çš„å…³é”®è¯"}'
```

### 5. URL å…³é”®è¯å¤„ç†

å¦‚æœæ•°æ®åº“ä¸­çš„å…³é”®è¯æ˜¯ URL æ ¼å¼ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨ï¼š
- æå– URL è·¯å¾„ä¸­æœ€åä¸€ä¸ª `/` åçš„éƒ¨åˆ†
- å°† `-` æ›¿æ¢ä¸ºç©ºæ ¼
- ä¾‹å¦‚ï¼š`https://example.com/path/my-keyword` â†’ `my keyword`

## æ–‡ä»¶ç»“æ„

```
keyword/
â”œâ”€â”€ package.json          # Node.js ä¾èµ–é…ç½®
â”œâ”€â”€ requirements.txt      # Python ä¾èµ–é…ç½®
â”œâ”€â”€ .gitignore            # Git å¿½ç•¥æ–‡ä»¶é…ç½®
â”œâ”€â”€ server.js             # Node.js åç«¯æœåŠ¡
â”œâ”€â”€ index.html            # ä¸»é¡µé¢
â”œâ”€â”€ defaultkw.json        # é»˜è®¤å…³é”®è¯å­˜å‚¨
â”œâ”€â”€ import_keywords.py    # Python å¯¼å…¥å·¥å…·
â”œâ”€â”€ init-data.js          # åˆå§‹åŒ–ç¤ºä¾‹æ•°æ®
â”œâ”€â”€ README.md            # è¯´æ˜æ–‡æ¡£
â””â”€â”€ ä½¿ç”¨ç¤ºä¾‹.md          # ä½¿ç”¨ç¤ºä¾‹å’Œæ•™ç¨‹
```

## API æ¥å£

### è·å–é»˜è®¤å…³é”®è¯
```
GET /api/defaultkw
```

### ä¿å­˜é»˜è®¤å…³é”®è¯
```
POST /api/defaultkw
Body: {"keyword": "å…³é”®è¯"}
```

### è·å–æ•°æ®åº“å…³é”®è¯
```
GET /api/keywords?before=2024-01-01T00:00:00
```

### æ·»åŠ å…³é”®è¯åˆ°æ•°æ®åº“
```
POST /api/keywords
Body: {"keyword": "å…³é”®è¯"}
```

### æ›´æ–°å…³é”®è¯ä½¿ç”¨æ—¶é—´
```
PUT /api/keywords/use-batch
Body: {"keywords": ["å…³é”®è¯1", "å…³é”®è¯2"]}
```

## æ•°æ®åº“ç»“æ„

MongoDB é›†åˆ `keywords` ä¸­çš„æ–‡æ¡£ç»“æ„ï¼š

```json
{
  "_id": "ObjectId",
  "keyword": "å…³é”®è¯å†…å®¹",
  "first_created_time": "2024-01-01T00:00:00.000Z",
  "last_used_time": "2024-01-01T00:00:00.000Z"
}
```

## ç‰ˆæœ¬æ§åˆ¶

é¡¹ç›®åŒ…å«äº†å®Œæ•´çš„ `.gitignore` æ–‡ä»¶ï¼Œä¼šè‡ªåŠ¨å¿½ç•¥ä»¥ä¸‹æ–‡ä»¶ï¼š

- **ä¾èµ–æ–‡ä»¶**: `node_modules/`, `__pycache__/`, è™šæ‹Ÿç¯å¢ƒç­‰
- **ç³»ç»Ÿæ–‡ä»¶**: `.DS_Store`, `Thumbs.db` ç­‰æ“ä½œç³»ç»Ÿç”Ÿæˆçš„æ–‡ä»¶
- **ç¼–è¾‘å™¨æ–‡ä»¶**: `.vscode/`, `.idea/` ç­‰IDEé…ç½®æ–‡ä»¶
- **ä¸´æ—¶æ–‡ä»¶**: æ—¥å¿—ã€ç¼“å­˜ã€ä¸´æ—¶æ–‡ä»¶ç­‰
- **æµ‹è¯•æ–‡ä»¶**: æµ‹è¯•ç”¨çš„Excelæ–‡ä»¶ï¼ˆ`test_*.xlsx`, `sample_*.xlsx`ï¼‰
- **ç¯å¢ƒé…ç½®**: `.env` ç­‰åŒ…å«æ•æ„Ÿä¿¡æ¯çš„æ–‡ä»¶

å¦‚æœæ‚¨éœ€è¦æäº¤æµ‹è¯•æ–‡ä»¶æˆ–å…¶ä»–è¢«å¿½ç•¥çš„æ–‡ä»¶ï¼Œå¯ä»¥ä¿®æ”¹ `.gitignore` æ–‡ä»¶ã€‚

## æ³¨æ„äº‹é¡¹

1. ç¡®ä¿ MongoDB æœåŠ¡æ­£åœ¨è¿è¡Œ
2. ç«¯å£ 3000 æœªè¢«å ç”¨
3. æµè§ˆå™¨éœ€è¦æ”¯æŒç°ä»£ JavaScript åŠŸèƒ½
4. ç‚¹å‡» Google Trends æŒ‰é’®éœ€è¦ç½‘ç»œè¿æ¥
5. Python å¯¼å…¥å·¥å…·éœ€è¦ Python 3.6+ ç¯å¢ƒ
6. æ”¯æŒçš„æ–‡ä»¶æ ¼å¼ï¼š.xlsx, .xls, .et, .ett

## æ•…éšœæ’é™¤

### Node.js ç›¸å…³é—®é¢˜
- å¦‚æœæ— æ³•è¿æ¥æ•°æ®åº“ï¼Œæ£€æŸ¥ MongoDB æœåŠ¡æ˜¯å¦è¿è¡Œ
- å¦‚æœé¡µé¢æ— æ³•åŠ è½½ï¼Œæ£€æŸ¥ Node.js æœåŠ¡æ˜¯å¦æ­£å¸¸å¯åŠ¨
- å¦‚æœå…³é”®è¯ä¿å­˜å¤±è´¥ï¼Œæ£€æŸ¥æ–‡ä»¶å†™å…¥æƒé™

### Python å¯¼å…¥å·¥å…·é—®é¢˜
- å¦‚æœå¯¼å…¥å·¥å…·æ— æ³•å¯åŠ¨ï¼Œæ£€æŸ¥æ˜¯å¦å®‰è£…äº† Python 3.6+
- å¦‚æœå‡ºç°æ¨¡å—å¯¼å…¥é”™è¯¯ï¼Œè¿è¡Œ `pip install -r requirements.txt`
- å¦‚æœæ— æ³•è¯»å–Excelæ–‡ä»¶ï¼Œæ£€æŸ¥æ–‡ä»¶æ ¼å¼æ˜¯å¦æ”¯æŒ
- å¦‚æœæ•°æ®åº“è¿æ¥å¤±è´¥ï¼Œç¡®ä¿MongoDBæœåŠ¡æ­£åœ¨è¿è¡Œä¸”ç«¯å£æ­£ç¡®

### å¸¸è§é”™è¯¯è§£å†³
- `ModuleNotFoundError: No module named 'pandas'` â†’ è¿è¡Œ `pip install pandas`
- `ModuleNotFoundError: No module named 'pymongo'` â†’ è¿è¡Œ `pip install pymongo`
- `ModuleNotFoundError: No module named 'openpyxl'` â†’ è¿è¡Œ `pip install openpyxl`
- æ–‡ä»¶è¯»å–å¤±è´¥ â†’ æ£€æŸ¥æ–‡ä»¶æ˜¯å¦è¢«å…¶ä»–ç¨‹åºå ç”¨ 




// æ·»åŠ å…¨å±€è°ƒè¯•å·¥å…·
        window.trendsDebug = {
            // ä¸€é”®è¯Šæ–­é—®é¢˜
            diagnose: () => {
                console.log('ğŸ¥ å¼€å§‹è¯Šæ–­æ’ä»¶é—®é¢˜...');
                console.log('='.repeat(50));
                
                // 1. æ£€æŸ¥é¡µé¢
                console.log('1ï¸âƒ£ æ£€æŸ¥é¡µé¢çŠ¶æ€:');
                console.log('   URL:', window.location.href);
                console.log('   æ˜¯å¦åœ¨Google Trends:', window.location.href.includes('trends.google.com/trends/explore'));
                console.log('   é¡µé¢æ ‡é¢˜:', document.title);
                
                // 2. æ£€æŸ¥æ’ä»¶çŠ¶æ€
                console.log('\n2ï¸âƒ£ æ£€æŸ¥æ’ä»¶çŠ¶æ€:');
                console.log('   æ’ä»¶å·²åŠ è½½:', typeof window.collector !== 'undefined');
                console.log('   ç›‘å¬çŠ¶æ€:', window.collector?.isMonitoring);
                console.log('   å¾…é‡‡é›†æ•°é‡:', window.collector?.pendingKeywords?.size || 0);
                console.log('   å·²æ‹¦æˆªæ•°é‡:', window.collector?.interceptedKeywords?.size || 0);
                
                // 3. æ£€æŸ¥ç½‘ç»œè¯·æ±‚
                console.log('\n3ï¸âƒ£ æ£€æŸ¥ç½‘ç»œè¯·æ±‚:');
                const totalRequests = window.interceptedRequests?.length || 0;
                const trendsRequests = window.interceptedRequests?.filter(req => 
                    req.url.includes('relatedsearches')
                ).length || 0;
                console.log('   æ€»è¯·æ±‚æ•°:', totalRequests);
                console.log('   ç›¸å…³æŸ¥è¯¢è¯·æ±‚æ•°:', trendsRequests);
                
                if (trendsRequests > 0) {
                    console.log('   ç›¸å…³æŸ¥è¯¢è¯·æ±‚:');
                    window.interceptedRequests
                        .filter(req => req.url.includes('relatedsearches'))
                        .forEach(req => {
                            console.log(`     ${req.method} ${req.url}`);
                        });
                }
                
                // 4. æ£€æŸ¥é¡µé¢æ•°æ®
                console.log('\n4ï¸âƒ£ æ£€æŸ¥é¡µé¢æ•°æ®:');
                let foundHighValue = 0;
                document.querySelectorAll('*').forEach(el => {
                    const text = el.textContent;
                    if (text && text.includes('%')) {
                        const matches = text.match(/(\d+(?:,\d+)?(?:\.\d+)?)%/g);
                        if (matches) {
                            matches.forEach(match => {
                                const value = parseFloat(match.replace(',', ''));
                                if (value >= 300) foundHighValue++;
                            });
                        }
                    }
                });
                console.log('   é¡µé¢ä¸­>=300%çš„å…ƒç´ :', foundHighValue);
                
                // 5. å»ºè®®
                console.log('\n5ï¸âƒ£ è¯Šæ–­å»ºè®®:');
                if (!window.location.href.includes('trends.google.com/trends/explore')) {
                    console.log('   âŒ è¯·è®¿é—® Google Trends æ¢ç´¢é¡µé¢');
                }
                if (totalRequests === 0) {
                    console.log('   âŒ æ²¡æœ‰æ‹¦æˆªåˆ°ä»»ä½•è¯·æ±‚ï¼Œè¯·åˆ·æ–°é¡µé¢');
                }
                if (trendsRequests === 0 && totalRequests > 0) {
                    console.log('   âš ï¸ æœ‰è¯·æ±‚ä½†æ²¡æœ‰ç›¸å…³æŸ¥è¯¢è¯·æ±‚ï¼Œè¯·åœ¨é¡µé¢ä¸­æœç´¢å…³é”®è¯');
                }
                if (foundHighValue === 0) {
                    console.log('   âš ï¸ é¡µé¢æ²¡æœ‰é«˜ä»·å€¼å…³é”®è¯ï¼Œå°è¯•æœç´¢çƒ­é—¨è¯é¢˜');
                }
                if (foundHighValue > 0 && (window.collector?.pendingKeywords?.size || 0) === 0) {
                    console.log('   ğŸ”§ é¡µé¢æœ‰æ•°æ®ä½†æœªé‡‡é›†åˆ°ï¼Œå¯èƒ½éœ€è¦å‘ä¸‹æ»šåŠ¨æŸ¥çœ‹"ç›¸å…³æŸ¥è¯¢"');
                }
                
                console.log('='.repeat(50));
            },
            
            // æ˜¾ç¤ºæ‰€æœ‰æ‹¦æˆªçš„URL
            showRequests: () => {
                console.log('ğŸ“‹ å·²æ‹¦æˆªçš„è¯·æ±‚åˆ—è¡¨:');
                if (window.interceptedRequests && window.interceptedRequests.length > 0) {
                    window.interceptedRequests.forEach((req, index) => {
                        console.log(`${index + 1}. ${req.method} ${req.url}`);
                    });
                    
                    // è¿‡æ»¤ç›¸å…³æŸ¥è¯¢è¯·æ±‚
                    const trendsRequests = window.interceptedRequests.filter(req => 
                        req.url.includes('relatedsearches')
                    );
                    console.log(`å…¶ä¸­ ${trendsRequests.length} ä¸ªæ˜¯ç›¸å…³æŸ¥è¯¢è¯·æ±‚`);
                } else {
                    console.log('æš‚æ— æ‹¦æˆªçš„è¯·æ±‚');
                }
            },
            
            // æ‰‹åŠ¨æµ‹è¯•
            test: () => {
                console.log('ğŸ§ª æ‰‹åŠ¨æµ‹è¯•é‡‡é›†åŠŸèƒ½...');
                if (window.collector) {
                    console.log('å¾…é‡‡é›†æ•°é‡:', window.collector.pendingKeywords.size);
                    console.log('å·²æ‹¦æˆªæ•°é‡:', window.collector.interceptedKeywords.size);
                } else {
                    console.log('âŒ æ”¶é›†å™¨æœªåŠ è½½');
                }
            }
        };
        
        // æ·»åŠ å³æ—¶æ£€æŸ¥åŠŸèƒ½åˆ° trendsDebug
        window.trendsDebug.check = () => {
            console.log('ğŸ” å³æ—¶çŠ¶æ€æ£€æŸ¥:');
            console.log('   å½“å‰æ—¶é—´:', new Date().toLocaleTimeString());
            console.log('   window.collector å­˜åœ¨:', !!window.collector);
            console.log('   window.collector ç±»å‹:', typeof window.collector);
            console.log('   window.trendsDebug å­˜åœ¨:', !!window.trendsDebug);
            console.log('   window.interceptedRequests é•¿åº¦:', window.interceptedRequests?.length || 0);
            
            if (window.collector) {
                console.log('   âœ… æ’ä»¶å·²æ­£ç¡®åŠ è½½');
                console.log('   æ’ä»¶ç›‘å¬çŠ¶æ€:', window.collector.isMonitoring);
                console.log('   å¾…é‡‡é›†æ•°é‡:', window.collector.pendingKeywords?.size || 0);
                console.log('   å·²æ‹¦æˆªæ•°é‡:', window.collector.interceptedKeywords?.size || 0);
            } else {
                console.log('   âŒ æ’ä»¶æœªåŠ è½½');
            }
            
            return {
                collectorExists: !!window.collector,
                trendsDebugExists: !!window.trendsDebug,
                requestCount: window.interceptedRequests?.length || 0
            };
        };